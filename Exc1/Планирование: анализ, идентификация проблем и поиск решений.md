# Планирование: анализ, идентификация проблем и поиск решений

## Анализ системы

Система состоит из 3х основных бизнес компонентов:

* Shop - отвечает за создание заказов от физ. лиц и конструктор моделей изделия
* CRM - отвечает за внутренний менеджмент заказов и заказы от юр. лиц
* MES - отвечает за расчет стоимости заказа, обработку стадий готовности заказа от взятия заказа до отправки, работу с операторами

а также 2х технических:

* Очередь сообщений (RabbitMQ)
* S3 file storage

## Проблемы

Проанализировав отзывы пользователей, а также общее устройство системы можно сделать следующие выводы:

* на данный момент система не справляется с повышенными нагрузками, что приводит к низким показателям времени отклика и удовлетворенности клиентов и производителей
* существуют критичные проблемы, связанные с потерей важных для бизнеса данных, что ломает производственные цепочки
* расчет стоимости изделия нуждается в оптимизации, так как этот функционал является самым ресурсоемким и нагруженным функционалом системы

* очевидным слабым местом является система MES, так как объединяет в себе большое количество бизнес функций с разными требованиям к масштабированию и нагрузке
* отсутствие систем мониторинга, логирования и трассировок. Что не позволяет оперативно выявлять места с проседающей производительностью и  анализировать изменения в скорости работы между релизами

* отсутствие возможности автоматического развертывания системы на release и prod системах является слабым местом как в рамках нерационального использования трудового времени сотрудников, так и рисков возникновения проблем из-за наличия человеческого фактора
* так как CRM и Shop используют общую БД, то это может замедлять скорость разработки из-за зависимостей, а также является единой точкой отказа
* ручное тестирование в данном случае не является лучшим решением, так как количество сложной бизнес логики невелико, что позволяет переложить на автоматическое тестирование большую часть функционала. Это повысит отказоустойчивость, а также будет гарантировать минимальную работоспособность системы. Также необходимо внедрение нагрузочного тестирования, для оценки скорости обработки сообщений, а также возможных просадок производительности, связанных с новым функционалом
* при растущих нагрузках, возможно, появиться необходимость в системе автоматического горизонтального масштабирования. Так как система развернута в облачной среде, то проблем с этим возникнуть не должно

## Возможные решения

1) Добавить систему для логирования, мониторинга и трассировок - позволит улучить наблюдаемость системы и принять необходимые действия по оптимизации, исключения потери данных и адаптации к повышенным нагрузкам
2) Разбить систему MES на несколько независимых сервисов: сервис расчета стоимости, сервис отслеживания статусов заказа, сервис операторов
3) Заняться оптимизацией расчета стоимости изделия
4) Добавить кеширование
5) Внедрить CI/CD для release и prod стендов
6) Покрыть систему автотестами, добавить регулярное нагрузочное тестирование
7) Настроить автоматическое масштабирование
8) Разнести базы Shop и CRM
9) Перевести всю систему на Event-Driven
10) Озаботиться созданием реплик для очереди и S3 хранилища, так как потеря данных в этих системах будет критичной