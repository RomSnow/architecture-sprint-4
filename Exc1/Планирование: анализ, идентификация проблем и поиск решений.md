# Планирование: анализ, идентификация проблем и поиск решений

## Анализ системы

Система состоит из 3х основных бизнес компонентов:

* Shop - отвечает за создание заказов от физ. лиц и конструктор моделей изделия
* CRM - отвечает за внутренний менеджмент заказов и заказы от юр. лиц
* MES - отвечает за расчет стоимости заказа, обработку стадий готовности заказа от взятия заказа до отправки, работу с операторами

а также 2х технических:

* Очередь сообщений (RabbitMQ)
* S3 file storage

## Проблемы

Проанализировав отзывы пользователей, а также общее устройство системы можно сделать следующие выводы:

* очевидным слабым местом является система MES, так как объединяет в себе большое количество бизнес функций с разными требованиям к масштабированию и нагрузке
* отсутствие систем мониторинга, логирования и трассировок. Что не позволяет оперативно выявлять места с проседающей производительностью и  анализировать изменения в скорости работы между релизами

* отсутствие возможности автоматического развертывания системы на release и prod системах является слабым местом как в рамках нерационального использования трудового времени сотрудников, так и рисков возникновения проблем из-за наличия человеческого фактора
* так как CRM и Shop используют общую БД, то это может замедлять скорость разработки из-за зависимостей, а также является единой точкой отказа
* ручное тестирование в данном случае не является лучшим решением, так как количество сложной бизнес логики невелико, что позволяет переложить на автоматическое тестирование большую часть функционала. Это повысит отказоустойчивость, а также будет гарантировать минимальную работоспособность системы. Также необходимо внедрение нагрузочного тестирования, для оценки скорости обработки сообщений, а также возможных просадок производительности, связанных с новым функционалом
* при растущих нагрузках, возможно, появиться необходимость в системе автоматического горизонтального масштабирования. Так как система развернута в облачной среде, то проблем с этим возникнуть не должно

## Возможные решения

1) Добавить систему для логирования, мониторинга и трассировок
2) Разбить систему MES на несколько независимых сервисов: сервис расчета стоимости, сервис отслеживания статусов заказа, сервис операторов
3) Внедрить CI/CD для release и prod стендов
4) Покрыть систему автотестами, добавить регулярное нагрузочное тестирование
5) Настроить автоматическое масштабирование
6) Разнести базы Shop и CRM
7) Перевести всю систему на Event-Driven
8) Озаботиться созданием реплик для очереди и S3 хранилища, так как потеря данных в этих системах будет критичной